\documentclass{article}

\usepackage{polski}
%\usepackage[utf8]{inputenc}
\usepackage[cp1250]{inputenc} % for Windows
\usepackage{polski}
\usepackage{amssymb}
\usepackage{color}
\usepackage{amsmath}
\usepackage{Sweave}
\usepackage{enumerate}
\usepackage{hyperref}
\usepackage{float}

\title{Palmer Penguins: Statystyczna analiza danych}
\author{\textbf{408453, £ukasz Wala}, poniedzia³ek $14^{40}$\\ 
\textit{AGH, Wydzia³ Informatyki, Elektroniki i Telekomunikacji}\\
\textit{Rachunek prawdopodobieñstwa i statystyka 2021/2022}}
\date{Kraków, \today}


\begin{document}
\input{Szablon-concordance}
\maketitle


\textit{Ja, ni¿ej podpisany w³asnorêcznym podpisem deklarujê, ¿e przygotowa³em przedstawiony do oceny projekt samodzielnie i ¿adna jego czêœæ nie jest kopi¹ pracy innej osoby.}
\begin{flushright}
{............................................}
\end{flushright}

\section{Streszczenie raportu}
Raport powsta³ w oparciu o analizê cech 344 pingwinów zamieszkuj¹cych archipelag Palmera zebranych w latach 2007-2009.


\section{Opis danych}
Dane do projektu pochodz¹ z strony projektu \href{https://allisonhorst.github.io/palmerpenguins/articles/intro.html}{\texttt{palmerpenguins}}. Jest to projekt open-source maj¹cy dostarczyæ dataset do wizualizacji i eksploracji danych bêd¹cy alternatyw¹ dla \textit{Iris Dataset}, klasyka poœród materia³ów do nauki statystycznej analizy danych i uczenia maszynowego.

W sk³ad projektu wchodz¹ dwa zestawy danych: \textit{penguins\_raw} oraz jego uproszczona wersja \textit{penguins}. W tym projekcie u¿yta zostanie wersja \textit{penguins}. Dane zawieraj¹ 344 rekordy, gdzie ka¿dy odpowiada innemu pingwinowi opisanemu oœmioma atrybutami:

\begin{itemize}
  \item \textbf{species} - gatunek pingwina (zmienna jakoœciowa spoœród \textit{Adelie}, \textit{Chinstrap}, \textit{Gentoo}),
  \item \textbf{island} - wyspa w archipelagu Palmera (zmienna jakoœciowa spoœród \textit{Biscoe}, \textit{Dream}, \textit{Torgersen}),
  \item \textbf{bill\_length\_mm} - d³ugoœæ dzioba (liczba zmiennoprzecinkowa, w milimetrach),
  \item \textbf{bill\_depth\_mm} - g³êbokoœæ dzioba (liczba zmiennoprzecinkowa, w milimetrach),
  \item \textbf{flipper\_length\_mm} - d³ugoœæ p³etwy (liczba ca³kowita, w milimetrach),
  \item \textbf{body\_mass\_g} - masa cia³a (liczba ca³kowita, w gramach),
  \item \textbf{sex} - p³eæ (zmienna jakoœciowa spoœród \textit{male}, \textit{female}),
  \item \textbf{year} - rok obserwacji (liczba ca³kowita, z zamiarem zmiany na zmienn¹ jakoœciow¹)
\end{itemize}

Do za³adowania ich do œrodowiska R mo¿na podejœæ na dwa sposoby. Z racji tego, ¿e jest to zestaw danych przygotowanych z myœl¹ o edukacji, zosta³ spakowany do pakietu R, który mo¿na zainstalowaæ poprzez CRAN, a nastêpnie za³adowaæ:
\begin{Schunk}
\begin{Sinput}
> install.packages("palmerpenguins", repos = "https://cloud.r-project.org/")
> library(palmerpenguins)
> data(package = 'palmerpenguins')
> penguins_data <- penguins
\end{Sinput}
\end{Schunk}
Alternatywnym podejœciem bêdzie pobranie pliku \textit{.csv} z \href{https://github.com/allisonhorst/palmerpenguins/tree/master/inst/extdata}{\texttt{repozytorium projektu}} i za³adowanie go:
\begin{Schunk}
\begin{Sinput}
> penguins_data <- read.csv(file = "penguins.csv", header = TRUE, stringsAsFactors = TRUE)
\end{Sinput}
\end{Schunk}
Czyszczenie danych sprowadzi siê tylko do usuniêcia rekordów z wartoœciami nieznanymi, które s¹ numeryczne (s¹ tylko dwa takie wiersze i nie zawieraj¹ one ¿adnego z pomiarów, wiêc nie poskutkuje to du¿¹ utrat¹ informacji). W przypadku nieznanych zmiennych jakoœciowych (tylko p³ci pingwinów w tym przypadku), jedn¹ z metod by³oby zast¹pienie ich losowymi wartoœciami, jednak ze wzglêdu na potencjalnie du¿¹ korelacjê p³ci z pozosta³ymi cechami, nie jest to najlepsze rozwi¹zanie. Najlepsz¹ metod¹ by³oby zbadanie zale¿noœci cech i p³ci, i na tej podstawie uzupe³nienie danych, jednak, dla uproszczenia oraz ze wzglêdu na niewielk¹ iloœæ takich wierszy, tutaj zostan¹ usuniête. Inn¹ niewielk¹ zmian¹ bêdzie bêdzie konwersja typu roku obserwacji z liczby na zmienn¹ jakoœciow¹, w tym przypadku ma to wiêcej sensu, bo bardziej interesuj¹cymi informacjami s¹ cechy pingwinów w danym roku ni¿ œrednia lat wykonywania pomiarów:
\begin{Schunk}
\begin{Sinput}
> penguins_data <- na.omit(penguins_data)
> penguins_data$year <- as.factor(penguins_data$year)
\end{Sinput}
\end{Schunk}
Wówczas dane wygl¹daæ bêd¹ nastêpuj¹co:
\begin{Schunk}
\begin{Sinput}
> str(penguins_data)
\end{Sinput}
\begin{Soutput}
'data.frame':	333 obs. of  8 variables:
 $ species          : Factor w/ 3 levels "Adelie","Chinstrap",..: 1 1 1 1 1 1 1 1 1 1 ...
 $ island           : Factor w/ 3 levels "Biscoe","Dream",..: 3 3 3 3 3 3 3 3 3 3 ...
 $ bill_length_mm   : num  39.1 39.5 40.3 36.7 39.3 38.9 39.2 41.1 38.6 34.6 ...
 $ bill_depth_mm    : num  18.7 17.4 18 19.3 20.6 17.8 19.6 17.6 21.2 21.1 ...
 $ flipper_length_mm: int  181 186 195 193 190 181 195 182 191 198 ...
 $ body_mass_g      : int  3750 3800 3250 3450 3650 3625 4675 3200 3800 4400 ...
 $ sex              : Factor w/ 2 levels "female","male": 2 1 1 1 2 1 2 1 2 2 ...
 $ year             : Factor w/ 3 levels "2007","2008",..: 1 1 1 1 1 1 1 1 1 1 ...
 - attr(*, "na.action")= 'omit' Named int [1:11] 4 9 10 11 12 48 179 219 257 269 ...
  ..- attr(*, "names")= chr [1:11] "4" "9" "10" "11" ...
\end{Soutput}
\end{Schunk}


\section{Analiza danych}
\subsection{Wydobywanie podstawowych informacji z danych}
Na pocz¹tku zostan¹ obliczone estymatory punktowe podstawowych wielkoœci statystyki opisowej:
\begin{Schunk}
\begin{Sinput}
> summary(penguins_data)
\end{Sinput}
\begin{Soutput}
      species          island    bill_length_mm  bill_depth_mm  
 Adelie   :146   Biscoe   :163   Min.   :32.10   Min.   :13.10  
 Chinstrap: 68   Dream    :123   1st Qu.:39.50   1st Qu.:15.60  
 Gentoo   :119   Torgersen: 47   Median :44.50   Median :17.30  
                                 Mean   :43.99   Mean   :17.16  
                                 3rd Qu.:48.60   3rd Qu.:18.70  
                                 Max.   :59.60   Max.   :21.50  
 flipper_length_mm  body_mass_g       sex        year    
 Min.   :172       Min.   :2700   female:165   2007:103  
 1st Qu.:190       1st Qu.:3550   male  :168   2008:113  
 Median :197       Median :4050                2009:117  
 Mean   :201       Mean   :4207                          
 3rd Qu.:213       3rd Qu.:4775                          
 Max.   :231       Max.   :6300                          
\end{Soutput}
\begin{Sinput}
> # zmienne jakoœciowe ignorowane
> describeBy(penguins_data[c(3:6)])
\end{Sinput}
\begin{Soutput}
                  vars   n    mean     sd median trimmed    mad    min    max
bill_length_mm       1 333   43.99   5.47   44.5   43.98   6.97   32.1   59.6
bill_depth_mm        2 333   17.16   1.97   17.3   17.19   2.22   13.1   21.5
flipper_length_mm    3 333  200.97  14.02  197.0  200.36  16.31  172.0  231.0
body_mass_g          4 333 4207.06 805.22 4050.0 4159.46 889.56 2700.0 6300.0
                   range  skew kurtosis    se
bill_length_mm      27.5  0.04    -0.90  0.30
bill_depth_mm        8.4 -0.15    -0.91  0.11
flipper_length_mm   59.0  0.36    -0.98  0.77
body_mass_g       3600.0  0.47    -0.75 44.13
\end{Soutput}
\end{Schunk}

Poni¿ej kilka wykresów przedstawiaj¹cych cechy numeryczne:

\begin{figure}[H]
\centering
\includegraphics{Szablon-007}
\end{figure}

Jak widaæ, dla wszystkich cech, z wyj¹tkiem \textit{bill\_depth\_mm}, \textit{skew}, czyli wspó³czynnik skoœnoœci przyjmuje wartoœci dodatnie, oznacza to, ¿e rozk³ady s¹ (w niewielkim stopniu, bo wartoœci \textit{skew} nadal bliskie zera) prawostronnie asymetryczne (maj¹ wyd³u¿one prawe ramiê rozk³adu). Rozk³ad \textit{bill\_depth\_mm} jest w podobnym stopniu lewostronnie asymetryczny. Na podstawie wartoœci kurtozy, która dla ka¿dej cechy jest ujemna, mo¿na stwierdziæ, ¿e intensywnoœæ wartoœci skrajnych jest mniejsza ni¿ w przypadku rozk³adu normalnego. Dobrze obrazuj¹ to poni¿sze wykresy gêstoœci prawdopodobieñstwa:

\begin{figure}[H]
\centering
\includegraphics{Szablon-008}
\end{figure}

Badanie, czy dane pochodz¹ z jakiegoœ rozk³adu, zostanie przeprowadzone w dalszej czêœci dokumentu, ale ju¿ teraz, na podstawie wykresów gêstoœci i ich podobieñstwa do wykresu gêstoœci rozk³adu normalnego, mo¿na snuæ pewne przypuszczenia na ten temat.

\subsection{Badanie zale¿noœci pomiêdzy danymi}
Na pocz¹tku pod lupê zostan¹ wziête zmienne jakoœciowe i zale¿noœci pomiêdzy nimi.
\begin{Schunk}
\begin{Sinput}
> # gatunek, a wyspa, na której zostal zaobserwowany
> penguins_data %>% count(species, island)
\end{Sinput}
\begin{Soutput}
    species    island   n
1    Adelie    Biscoe  44
2    Adelie     Dream  55
3    Adelie Torgersen  47
4 Chinstrap     Dream  68
5    Gentoo    Biscoe 119
\end{Soutput}
\end{Schunk}
\begin{figure}[H]
\centering
\includegraphics{Szablon-010}
\end{figure}
\begin{Schunk}
\begin{Sinput}
> # gatunek, a pleæ
> penguins_data %>% count(sex, species)
\end{Sinput}
\begin{Soutput}
     sex   species  n
1 female    Adelie 73
2 female Chinstrap 34
3 female    Gentoo 58
4   male    Adelie 73
5   male Chinstrap 34
6   male    Gentoo 61
\end{Soutput}
\end{Schunk}
\begin{figure}[H]
\centering
\includegraphics{Szablon-012}
\end{figure}
\begin{Schunk}
\begin{Sinput}
> # wyspa, na której dokonano pomiaru, a pleæ
> penguins_data %>% count(sex, island)
\end{Sinput}
\begin{Soutput}
     sex    island  n
1 female    Biscoe 80
2 female     Dream 61
3 female Torgersen 24
4   male    Biscoe 83
5   male     Dream 62
6   male Torgersen 23
\end{Soutput}
\end{Schunk}
\begin{figure}[H]
\centering
\includegraphics{Szablon-014}
\end{figure}

Ciekaw¹ cech¹, któr¹ mo¿na tutaj zauwa¿yæ, jest to, ¿e tylko gatunek \textit{Adelie} ¿yje wszystkie na wszystkich trzech wyspach, reszta gatunków zamieszkuje jedn¹ wyspê. Rozk³ad p³ci wzglêdem gatunku oraz wyspy wystêpowanie jest praktycznie równomierny, trudno zaobserwowaæ inne zale¿noœci pomiêdzy cechami jakoœciowymi.

Teraz zale¿noœci pomiêdzy cechami numerycznymi i jakoœciowymi. Dla uproszczenia pod uwagê wziête zostan¹ tylko œrednie wartoœci grupowane po cechach jakoœciowych.
\begin{Schunk}
\begin{Sinput}
> # zaleznosc pomiedzy gatunkiem a cechami numerycznymi
> penguins_data %>% group_by(species) %>% summarise(across(-c(island, sex, year), mean))
\end{Sinput}
\begin{Soutput}
# A tibble: 3 x 5
  species   bill_length_mm bill_depth_mm flipper_length_mm body_mass_g
  <fct>              <dbl>         <dbl>             <dbl>       <dbl>
1 Adelie              38.8          18.3              190.       3706.
2 Chinstrap           48.8          18.4              196.       3733.
3 Gentoo              47.6          15.0              217.       5092.
\end{Soutput}
\end{Schunk}

\begin{figure}[H]
\centering
\includegraphics{Szablon-016}
\end{figure}

Jak widaæ na podstawie œrednich, cechy numeryczne pingwinów z gatunków \textit{Adelie} oraz \textit{Chinstrap} nie ró¿ni¹ siê bardzo z wyj¹tkiem d³ugoœci dzioba (œrednio nieznacznie d³u¿sze u \textit{Chinstrap}). Pingwiny gatunku \textit{Gentoo} wyró¿niaj¹ siê natomiast œrednio krótszymi g³êbokoœciami dzioba, ale wiêkszymi masami cia³a. 

\begin{Schunk}
\begin{Sinput}
> # zaleznosc pomiedzy wyspa wystepowania a cechami numerycznymi
> penguins_data %>% group_by(island) %>% summarise(across(-c(species, sex, year), mean))
\end{Sinput}
\begin{Soutput}
# A tibble: 3 x 5
  island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g
  <fct>              <dbl>         <dbl>             <dbl>       <dbl>
1 Biscoe              45.2          15.9              210.       4719.
2 Dream               44.2          18.3              193.       3719.
3 Torgersen           39.0          18.5              192.       3709.
\end{Soutput}
\end{Schunk}
Nale¿y pamiêtaæ, ¿e gatunek jest mocno skorelowany z wysp¹ wystêpowania, wiêc grupowanie danych po wyspach nie wprowadza wiele nowych danych.

\begin{Schunk}
\begin{Sinput}
> # zaleznosc pomiedzy plcia a cechami numerycznymi
> penguins_data %>% group_by(species, sex) %>% summarise(across(-c(island, year), mean))
\end{Sinput}
\begin{Soutput}
# A tibble: 6 x 6
# Groups:   species [3]
  species   sex    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g
  <fct>     <fct>           <dbl>         <dbl>             <dbl>       <dbl>
1 Adelie    female           37.3          17.6              188.       3369.
2 Adelie    male             40.4          19.1              192.       4043.
3 Chinstrap female           46.6          17.6              192.       3527.
4 Chinstrap male             51.1          19.3              200.       3939.
5 Gentoo    female           45.6          14.2              213.       4680.
6 Gentoo    male             49.5          15.7              222.       5485.
\end{Soutput}
\end{Schunk}
Samce pingwinów, niezale¿nie od gatunku, przewa¿aj¹ pod wzglêdem ka¿dej cechy, szczególnie masy cia³a.

Teraz pora na zbadanie zale¿noœci pomiêdzy cechami numerycznymi. Równie¿ mo¿na by to rozbiæ, rozbijaj¹c dane na grupy wzglêdem cech jakoœciowych, ale tutaj, dla uproszczenia, u¿yte zostan¹ dane z ca³ej próby. Najpierw obliczona zostanie macierz korelacji dla cech numerycznych:
\begin{Schunk}
\begin{Sinput}
> corr <- round(cor(penguins_data[c(3:6)]), 2)
\end{Sinput}
\end{Schunk}
\begin{figure}[H]
\centering
\includegraphics{Szablon-020}
\end{figure}

Mo¿na zaobserwowaæ m.in. wysoki wspó³czynnik korelacji pomiêdzy mas¹ cia³a pingwina, a d³ugoœci¹ p³etwy (skrzyd³a). £atwo to zaobserwowaæ na poni¿szym wykresie:
\begin{figure}[H]
\centering
\includegraphics{Szablon-021}
\end{figure}

Natomiast np. d³ugoœæ i g³êbokoœæ dzioba wykazuj¹ ni¿szy poziom korelacji:
\begin{figure}[H]
\centering
\includegraphics{Szablon-022}
\end{figure}



\subsection{Estymatory przedzia³owe}


\subsection{Testowanie hipotez}
TestowaÄ‡ bÄ™dziemy hipotezÄ™ zerowÄ… {\bf{H0}}: ... wobec hipotezy alternatywnej {\bf{H1}}: ...
Korzystam ze statystyki $t$-Studenta postaci
\begin{align*}
t=\sum_{i=1}^n\frac{licznik X_i}{mianownik^2}
\end{align*}

\subsection{Regresja}

W ten sposÃ³b moÅ¼na zapisaÄ‡ rÃ³wnania w \LaTeX, znakiem AND wyrÃ³wnujemy je, a dwa slashe sÅ‚uÅ¼Ä… do przejÅ›cia do kolejnej linii.
\begin{align*}
y&=a\cdot x+b+\varepsilon,\\
z&=3\cdot y.
\end{align*}

\section{Wnioski}
Wnioski pÅ‚ynÄ…ce z przeprowadzonej analizy, sÄ… nastÄ™pujÄ…ce:
\begin{itemize}
\item wniosek pierwszy,
\item wniosek drugi,
\item i kolejne.
\end{itemize}

\end{document}
